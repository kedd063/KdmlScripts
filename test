-- ⚡ Rayfield yükle
local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local TeleportService = game:GetService("TeleportService")
local HttpService = game:GetService("HttpService")
local player = Players.LocalPlayer

local Window = Rayfield:CreateWindow({
   Name = "Kdml Scripts",
   LoadingTitle = "Kdml Scripts",
   LoadingSubtitle = "by .gg/scVsN9E5YN",
   ConfigurationSaving = {
      Enabled = false
   },
   KeySystem = true,
   KeySettings = {
      Title = "Kdml Key System",
      Subtitle = "Kdml Scripts",
      Note = "get key from here: https://link-center.net/1030745/7V7ogJrjKJez",
      FileName = "KdmlKeyFile",
      SaveKey = true,
      GrabKeyFromSite = false,
      Key = {"we_are_better_than_lurk_hack_ig"}
   }
})

local MainTab = Window:CreateTab("Main", 4483362458)
local VisualTab = Window:CreateTab("Visual", 4483362458)
local MiscTab = Window:CreateTab("Misc", 4483362458)
local OtherTab = Window:CreateTab("Other Stuffs", 4483362458)

-- MAIN
MainTab:CreateButton({
   Name = "Free Cam",
   Callback = function()
      loadstring(game:HttpGet('https://raw.githubusercontent.com/GhostPlayer352/Test4/main/Freecam'))()
   end,
})

MainTab:CreateButton({
   Name = "Speed Boost",
   Callback = function()
      local boostedSpeed = 48
      local function applySpeedBoost()
         local char = player.Character or player.CharacterAdded:Wait()
         local humanoid = char:WaitForChild("Humanoid")
         humanoid.WalkSpeed = boostedSpeed
      end
      applySpeedBoost()
      player.CharacterAdded:Connect(function()
         task.wait(0.1)
         applySpeedBoost()
      end)
   end,
})

MainTab:CreateButton({
   Name = "Jump Boost",
   Callback = function()
      local character = player.Character or player.CharacterAdded:Wait()
      local humanoid = character:WaitForChild("Humanoid")
      humanoid.Jumping:Connect(function(active)
         if active then
            local rootPart = character:WaitForChild("HumanoidRootPart")
            rootPart.CFrame = rootPart.CFrame + Vector3.new(0, 55, 0)
         end
      end)
   end,
})

MainTab:CreateButton({
   Name = "Float",
   Callback = function()
      local floatActive = false
      local floatSpeed = 46
      local floatTime = 15
      local startTime = 0

      local gui = Instance.new("ScreenGui", player:WaitForChild("PlayerGui"))
      gui.Name = "FloatGUI"
      gui.ResetOnSpawn = false

      local frame = Instance.new("Frame")
      frame.Size = UDim2.new(0, 220, 0, 120)
      frame.Position = UDim2.new(0.5, -110, 0.7, 0)
      frame.BackgroundColor3 = Color3.fromRGB(20, 20, 30)
      frame.BorderColor3 = Color3.fromRGB(0, 170, 255)
      frame.BorderSizePixel = 3
      frame.Active = true
      frame.Draggable = true
      frame.Parent = gui

      local title = Instance.new("TextLabel")
      title.Size = UDim2.new(1, 0, 0, 30)
      title.BackgroundTransparency = 1
      title.Text = "Float"
      title.Font = Enum.Font.GothamBold
      title.TextSize = 18
      title.TextColor3 = Color3.fromRGB(0, 170, 255)
      title.Parent = frame

      local button = Instance.new("TextButton")
      button.Size = UDim2.new(0, 180, 0, 40)
      button.Position = UDim2.new(0.5, -90, 0, 40)
      button.BackgroundColor3 = Color3.fromRGB(0, 120, 255)
      button.TextColor3 = Color3.new(1,1,1)
      button.TextScaled = true
      button.Font = Enum.Font.GothamBold
      button.Text = "Start Float"
      button.Parent = frame

      local countdownLabel = Instance.new("TextLabel")
      countdownLabel.Size = UDim2.new(0, 180, 0, 25)
      countdownLabel.Position = UDim2.new(0.5, -90, 0, 85)
      countdownLabel.BackgroundTransparency = 1
      countdownLabel.TextColor3 = Color3.new(1, 1, 1)
      countdownLabel.Font = Enum.Font.Gotham
      countdownLabel.TextScaled = true
      countdownLabel.Text = "Ready"
      countdownLabel.Parent = frame

      local moveConnection, gravityConnection

      local function stopFloat()
         floatActive = false
         button.Text = "Start Float"
         if moveConnection then moveConnection:Disconnect() end
         if gravityConnection then gravityConnection:Disconnect() end
         countdownLabel.Text = "Done"
         gui:Destroy()
      end

      local function startFloat()
         floatActive = true
         button.Text = "Stop Float"
         startTime = tick()
         local char = player.Character or player.CharacterAdded:Wait()
         local hrp = char:WaitForChild("HumanoidRootPart")

         gravityConnection = RunService.Heartbeat:Connect(function()
            hrp.Velocity = Vector3.new(hrp.Velocity.X, 0, hrp.Velocity.Z)
         end)

         moveConnection = RunService.Heartbeat:Connect(function()
            if not floatActive then return end
            local elapsed = tick() - startTime
            local remaining = floatTime - elapsed
            countdownLabel.Text = string.format("Ending in: %.1f", math.max(remaining, 0))
            if remaining <= 0 then
               stopFloat()
            else
               local dir = workspace.CurrentCamera.CFrame.LookVector
               local move = Vector3.new(dir.X, 0, dir.Z).Unit
               hrp.Velocity = move * floatSpeed
            end
         end)
      end

      button.MouseButton1Click:Connect(function()
         if not floatActive then startFloat() else stopFloat() end
      end)
   end,
})

MainTab:CreateButton({
   Name = "Instant Steal",
   Callback = function()
      loadstring(game:HttpGet("https://raw.githubusercontent.com/kedd063/KdmlScripts/main/ins"))()
   end,
})

MainTab:CreateButton({
   Name = "TP To Cords (shhh)",
   Callback = function()
      loadstring(game:HttpGet("https://pastebin.com/raw/ERW19MbK"))()
   end,
})

-- VISUAL
local espObjects = {}
VisualTab:CreateToggle({
   Name = "ESP",
   CurrentValue = false,
   Callback = function(Value)
      if Value then
         for _, plr in pairs(Players:GetPlayers()) do
            if plr ~= player and plr.Character then
               local highlight = Instance.new("Highlight")
               highlight.FillColor = Color3.fromRGB(170,0,255)
               highlight.FillTransparency = 0.5
               highlight.OutlineTransparency = 0.7
               highlight.Adornee = plr.Character
               highlight.Parent = plr.Character
               espObjects[plr] = highlight
            end
         end
      else
         for _, hl in pairs(espObjects) do hl:Destroy() end
         espObjects = {}
      end
   end,
})

local secretConnection
VisualTab:CreateToggle({
   Name = "Secret Brainrots ESP",
   CurrentValue = false,
   Callback = function(Value)
      if Value then
         secretConnection = RunService.RenderStepped:Connect(function()
            for _, m in pairs(workspace:GetChildren()) do
               if table.find({
                  "Chimpanzini Spiderini","Los Tralaleritos","La Vacca Saturno Saturnita",
                  "Torrtuginni Dragonfruitini","Graipuss Medussi","La Grande Combinasion",
                  "Garamam and Madundung","Las Tralaleritas"
               }, m.Name) then
                  if not m:FindFirstChild("ESPBox") then
                     local box = Instance.new("BoxHandleAdornment")
                     box.Adornee = m.PrimaryPart or m:FindFirstChildWhichIsA("BasePart")
                     box.Size = box.Adornee.Size * Vector3.new(1.1,1.3,1.1)
                     box.Color3 = Color3.fromRGB(0,255,0)
                     box.AlwaysOnTop = true
                     box.Transparency = 0.5
                     box.Parent = box.Adornee
                     box.Name = "ESPBox"
                  end
               end
            end
         end)
      else
         if secretConnection then secretConnection:Disconnect() end
         for _, m in pairs(workspace:GetChildren()) do
            if m:FindFirstChild("ESPBox") then m.ESPBox:Destroy() end
         end
      end
   end,
})

local godConnection
VisualTab:CreateToggle({
   Name = "Brainrot God ESP",
   CurrentValue = false,
   Callback = function(Value)
      if Value then
         godConnection = RunService.RenderStepped:Connect(function()
            for _, m in pairs(workspace:GetChildren()) do
               if table.find({
                  "Tralalero Tralala","Cocofanto Elefanto","Matteo",
                  "Odin Din Din Dun","Girafa Celestre","Orcalero Orcala",
                  "Trenostruzzo Turbo 3000","Tigroligre Frutonni","Statutino Libertino",
                  "Gattatino Nyanino"
               }, m.Name) then
                  if not m:FindFirstChild("ESPBox") then
                     local box = Instance.new("BoxHandleAdornment")
                     box.Adornee = m.PrimaryPart or m:FindFirstChildWhichIsA("BasePart")
                     box.Size = box.Adornee.Size * Vector3.new(1.1,1.3,1.1)
                     box.Color3 = Color3.fromRGB(255,0,0)
                     box.AlwaysOnTop = true
                     box.Transparency = 0.5
                     box.Parent = box.Adornee
                     box.Name = "ESPBox"
                  end
               end
            end
         end)
      else
         if godConnection then godConnection:Disconnect() end
         for _, m in pairs(workspace:GetChildren()) do
            if m:FindFirstChild("ESPBox") then m.ESPBox:Destroy() end
         end
      end
   end,
})

-- MISC
for _, item in pairs({"Trap","Invisibility Cloak","Medusa's Head","Quantum Cloner","Body Swap Potion"}) do
   MiscTab:CreateButton({
      Name = item,
      Callback = function()
         local net = ReplicatedStorage:WaitForChild("Packages"):WaitForChild("Net"):WaitForChild("RF/CoinsShopService/RequestBuy")
         net:InvokeServer(item)
      end,
   })
end

-- OTHER
local spinEnabled = false
OtherTab:CreateToggle({
   Name = "Auto Candy Spin Wheel",
   CurrentValue = false,
   Callback = function(Value)
      spinEnabled = Value
      if Value then
         task.spawn(function()
            while spinEnabled do
               ReplicatedStorage:WaitForChild("Packages"):WaitForChild("Net"):WaitForChild("RE/CandyEventService/Spin"):FireServer()
               task.wait(1)
            end
         end)
      end
   end,
})

OtherTab:CreateButton({
   Name = "Server Hop",
   Callback = function()
      local PlaceId = game.PlaceId
      local JobId = game.JobId
      local servers = HttpService:JSONDecode(game:HttpGet("https://games.roblox.com/v1/games/"..PlaceId.."/servers/Public?sortOrder=Asc&limit=100"))
      for _, s in pairs(servers.data) do
         if s.id ~= JobId and s.playing < s.maxPlayers then
            TeleportService:TeleportToPlaceInstance(PlaceId,s.id,player)
            break
         end
      end
   end,
})

local fpsEnabled = false
OtherTab:CreateToggle({
   Name = "FPS Boost",
   CurrentValue = false,
   Callback = function(Value)
      if Value then
         settings().Rendering.QualityLevel = Enum.QualityLevel.Level01
         game:GetService("Lighting").GlobalShadows = false
         game:GetService("Lighting").FogEnd = 50
      else
         settings().Rendering.QualityLevel = Enum.QualityLevel.Automatic
      end
   end,
})
